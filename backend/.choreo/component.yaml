schemaVersion: "1.2"
type: service
name: backend
project: django-react

properties:
  container:
    port: 8000
  environment:
    CHOREO: "True"

build:
  command: "pip install -r requirements.txt"
  workingDir: "/"  # <-- Make sure Choreo builds from repo root

run:
  command: "python backend/manage.py migrate && gunicorn backend.wsgi:application --bind 0.0.0.0:8000 --timeout 120"
  workingDir: "/"  # <-- Run commands from repo root

endpoints:
  - name: rest-api
    displayName: REST API
    type: REST
    networkVisibilities:
      - Public
      - Project
    service:
      basePath: /
      port: 8000

